<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MapBox Exercise</title>
  <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />

</head>
<body>
<h2>My favorite restaurants</h2>
<label>Select Zoom</label>
  <select id="zoom-select">
    <option value="">--Please choose a zoom level--</option>
    <option id="5" class="zoom" value="5">5</option>
    <option id="15" class="zoom" value="15">15</option>
    <option id="20" class="zoom" value="20">20</option>
  </select>

<div id='map' style='width: 98vw; height: 98vh;'></div>
<script src="./js/keys.js"></script>
<script src="./js/mapbox-geocoder-utils.js"></script>
<script>

  mapboxgl.accessToken = mapboxAPIKey;

  var newMap = new mapboxgl.Map({
    container: 'map', // container ID
    style: 'mapbox://styles/youssefr90/ckr6ea0mv0nhc18pfhzzckhj3', // style URL
    center: [-95.3698, 29.7604], // starting position [lng, lat]
    zoom: 10 // starting zoom
  });

  var restaurants = [
    {
      name: 'Pho Saigon',
      location: '890 S Mason Rd, Katy TX',
      dishes: 'Soup'
    },
    {
      name: 'Ephesus Mediterranean Grill',
      location: '510 S Mason Rd, Katy TX',
      dishes: 'Greek and mediterranean'
    },
    {
      name: 'OMG Burger!',
      location: '1230 N Mason Rd, Katy Tx',
      dishes: 'Burgers'
    }
  ]

  restaurants.forEach(function (restaurant){
    geocode( restaurant.location, mapboxAPIKeY).then(function (results){
      var popup = new mapboxgl.Popup()
              .setHTML('<h6>'
                      + restaurant.name
                      +'<br>'
                      + restaurant.location
                      +'<br>'
                      + restaurant.dishes
                      + '</h6>')

      new mapboxgl.Marker({color: "orange"})
              .setLngLat(results)
              .setPopup(popup)
              .addTo(newMap)
    });
  })

  var zoomSelect = document.getElementById('zoom-select');
  console.log(zoomSelect);

  zoomSelect.addEventListener('change', function(){
    console.log('Zoom level change.');
    var zoomValue = zoomSelect.options[zoomSelect.selectedIndex].value;

    map.setZoom(zoomValue);
  });
</script>

</body>
</html>